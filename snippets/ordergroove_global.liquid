
{% comment %}

Do NOT change this file. It has been autogenerated by the Ordergroove Shopify App.
This file can be re-written at any time.
Last updated at: 2021-10-20T15:25:41.885Z / Version: 2.1.0

{%- render 'ordergroove_global' -%}

{% endcomment %}

<style>
  #ordergrooveCheckoutModal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    width: 320px;
    max-width: 100%;
    margin: 0;
    padding: 20px 0 10px;
    transform: translate(-50%, -50%);
    border: 0;
    box-shadow: 2px 0 10px rgba(54,54,54,0.2),-2px 0 10px rgba(54,54,54,0.2);
    background-color: #ffffff;
    z-index: 1;
  }

  #ordergrooveCheckoutModal[open] {
    display: block;
  }

  .ogmodal__signin {
    display: block;
  }

  .ogmodal__container {
    padding-left: 20px;
    padding-right: 20px;
  }

  .ogmodal__container + .ogmodal__container {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid #ddd;
  }

  #ordergrooveCheckoutModal + .backdrop {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
  }

  #ordergrooveCheckoutModal + .backdrop,
  #ordergrooveCheckoutModal::backdrop {
    background-color: #3d3d3d7d;
  }

  #ordergrooveCheckoutModal .ogmodal__menu {
    padding: 0;
    text-align: center;
  }
</style>

<dialog id="ordergrooveCheckoutModal">
  <div class="ogmodal__container">
    <a href="{{routes.account_register_url}}" class="Button Button--primary Button--full">Create Account</a>
  </div>
  <div class="ogmodal__container">
    {%- form 'customer_login', name: 'login', class: 'ogmodal__signin Form Form--spacingTight', id: 'customer_login_modal', style: login_default_visibility -%}
      {% comment %}
        Redirect the customer to checkout after login
      {% endcomment %}
      <input type="hidden" name="checkout_url" value="/checkout">

      <header class="Form__Header">
        <h1 class="Form__Title Heading u-h1">{{ 'customer.login.title' | t }}</h1>
      </header>

      {%- if form.errors -%}
        <p class="Form__Alert Alert Alert--error">
          {{- form.errors.messages['form'] -}}
        </p>
      {%- endif -%}

      <div class="Form__Item">
        <input type="email" class="Form__Input" name="customer[email]" required="required" placeholder="{{ 'customer.login.email' | t }}" aria-label="{{ 'customer.login.email' | t }}" autofocus>
        <label class="Form__FloatingLabel">{{ 'customer.login.email' | t }}</label>
      </div>

      <div class="Form__Item">
        <input type="password" class="Form__Input" name="customer[password]" required="required" placeholder="{{ 'customer.login.password' | t }}" aria-label="{{ 'customer.login.password' | t }}">
        <label class="Form__FloatingLabel">{{ 'customer.login.password' | t }}</label>
      </div>

      <button type="submit" class="Form__Submit Button Button--primary Button--full">{{ 'customer.login.submit' | t }}</button>
    {%- endform -%}
  </div>
  <form method="dialog">
    <menu class="ogmodal__menu">
      <button value="cancel">Cancel</button>
    </menu>
  </form>
</dialog>

<script>
  {%- assign secret_key = "8909a9bd0124c4fb650e602e1d41922a15f32451" -%}
  {%- assign customer_id = customer.id  -%}
  {%- assign timestamp = "now" | date: "%s" -%}
  {%- assign signature = customer_id | append: "|" | append: timestamp | hmac_sha256: secret_key -%}

  {% if template == 'cart' or template.name contains 'product' %}
  window.og_settings = {
    {%- if template == 'cart' -%}
      "page_type": "2",
    {%- else -%}
      "page_type": "1",
    {%- endif -%}
    {%- if customer -%}
    "logged_in": true,
    {%- else -%}
    "logged_in": false,
    {%- endif -%}
    "impulse_upsell": true,
    "cart": {
      "products": [
        {%- for line_item in cart.items -%}
        {
          "id": {{ line_item.variant_id }},
          "quantity": {{ line_item.quantity }},
          "unit_price": {{ line_item.final_price }}/100,
          "total_price": {{ line_item.final_line_price }}/100
        }{%- unless forloop.last == true -%},{%- endunless -%}
        {%- endfor -%}
      ]
    }
  };
  {% endif %}

  window.ogShopifyConfig = {
    {%- if customer -%}
      customer: {
        id: "{{customer.id}}",
        email: "{{customer.email}}",
        signature: "{{signature}}",
        timestamp: "{{timestamp}}",
      },
    {%- else -%}
      customer: null,
    {%- endif -%}
    settings: {
      reloadCart: true,
      blockGuestCheckout: false,
      gateway: "shopifyPayments",
      shouldUseSafeAssets: true
    }
  }
</script>
{%- render 'ordergroove_static_asset' -%}
{{ 'ordergroove.js' | asset_url | script_tag }}
